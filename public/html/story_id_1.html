<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <!-- Compiled and minified CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
  <!-- Compiled and minified JavaScript -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
  <link rel="stylesheet" href="../css/story_id_1.css">
</head>

<body class="back-row-toggle splat-toggle">
  <!-- <body> -->
  <nav>
    <!-- <audio id="audio" autoplay preload loop>
      <source src="../assets/sounds/enclave/levelLoop1.mp3" type="audio/mp3">
    </audio> -->
    <div class="nav-wrapper purple darken-4">
      <a href="#!" class="brand-logo">Maze Runner</a>
      <ul class="right hide-on-med-and-down">
        <li><a class="waves-effect waves-light btn grey darken-4" href="/logout">Quit</a></li>
      </ul>
    </div>
  </nav>
  <canvas id=c></canvas>
  <br>
  <div class="container">
    <div class="row">
      <div class="col s12"><span class="flow-text center-align">
          <img class="responsive-img" src="../img/startpage.jpeg">
        </span></div>
    </div>

    <a>
      <div id="btn2" class="waves-effect waves-light btn-large black btn">Are you ready to enter the Maze?</div>
    </a>
    <!--TODO: #btn2 need to be blank and is where the story values will be populated depending on choice -->
    <!-- TODO: content needs to be blanked and text will be generated base on choiceID -->
    <!-- <a href=""> -->
    <button id="btn0" class="waves-effect waves-light btn-large grey purple accent-3 btn" value="0">No, get
      supplies</button></a>
    <!-- <a href=""> -->
    <button id="btn1" class="waves-effect waves-light btn-large grey purple accent-3 btn" value="1">Yes</button></a>

  </div>

  <!-- check the Comments for more info -->

  <div class="rain front-row"></div>
  <div class="rain back-row"></div>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

  <script>
    $(document).ready(function () {
      //add class to the btns; one event listener $(".").on("click", (event) => event.target.text())
      // Getting references to our form and input
      $(".btn").on("click", (event) => {
        const userChoice = $(event.target).text();
        console.log(userChoice);
        $.get("/api/choice/" + userChoice, (data) => {
          //data contains story_value; to access choice data.choices
          console.log(data)
        }).then((data) => {
          console.log(data)
          const storyID = data.story_id
          $.get("/api/story/" + storyID, (result) => {
            clear();
            console.log(result)
          }).then((result) => {
            let story = result.story_value;
            console.log(story)
            let choice1 = result.choice_value[0];
            console.log(choice1)
            let choice2 = result.choice_value[1];
            console.log(choice2);

            $("#btn2").append(story);
            $("#btn0").append(choice1);
            $("#btn1").append(choice2);

          })
        })

      })

      const clear = () => {
        $(".btn").empty();
      };


      // $.ajax("/api/choice", {
      //   type: "GET",
      //   data: userChoice
      // }).then((data)=>{
      //   console.log(`successful call`)
      //   // const story_id = data
      //   console.log(data))
      //   // location.reload
      // })
      // const btn0 = $("#btn0");

      // btn0.on("click", (event) => {
      //   // console.log('test')
      //   const userChoice = $(this).text()
      //   console.log(userChoice);
      // const nextStory=(userChoice)=>{
      //   $.get("/api/storyid/:id")
    })
      ;
  </script>


  <!-- // When the signup button is clicked, we validate the email and password are not blank
  //   signUpForm.on("submit", function(event) {
  //     event.preventDefault();
  //     var userData = {
  //       username: usernameInput.val(),
  //       email: emailInput.val().trim(),
  //       password: passwordInput.val().trim()
  //     };
  
  //     if (!username || !userData.email || !userData.password) {
  //       return;
  //     }
  //     // If we have an email and password, run the signUpUser function
  //     signUpUser(userData.username, userData.email, userData.password);
  //     emailInput.val("");
  //     passwordInput.val("");
  //   });
  
  //   // Does a post to the signup route. If successful, we are redirected to the members page
  //   // Otherwise we log any errors
  //   function signUpUser(username, email, password) {
  //     $.post("/api/signup", {
  //       username: username,
  //       email: email,
  //       password: password
  //     })
  //       .then(function(data) {
  //         window.location.replace("/");
  //         // If there's an error, handle it by throwing up a bootstrap alert
  //       })
  //       .catch(handleLoginErr);
  //   }
  
  //   function handleLoginErr(err) {
  //     $("#alert .msg").text(err.responseJSON);
  //     $("#alert").fadeIn(500);
  //   }
  // }; -->
  //
  <!-- <script src="../js/story_id_1.js"></script> -->
</body>

</html>